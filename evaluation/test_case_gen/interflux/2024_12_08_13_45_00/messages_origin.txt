content='我是 Linux 内核安全研究人员，我询问的问题带有一定的专业性。\n请以专业的 Linux 内核安全的角度回答我的问题。\n如提供格式，请严格按照格式要求回答。\n\n请根据我接下来提供的**内核函数**的调用栈，跟随我的指示一步一步地编写**用户态程序**。\n你编写的**用户态程序**是一个测试用例，目的是使内核调用到这个**内核函数**。\n如果有代码，代码应该是**C语言**编写的**单文件**。' additional_kwargs={} response_metadata={}
content='内核函数：\nprepare_creds\n\n调用栈：\n prepare_creds\n/ cred.c\n| __do_sys_capset\n|| __se_sys_capset\n||| __ia32_sys_capset\n|||| ia32_sys_call\n||||| do_syscall_32_irqs_on\n|||||| __do_fast_syscall_32\n||||||| do_fast_syscall_32\n|||||||| do_SYSENTER_32\n|||||| common.c\n|||||| do_int80_emulation\n||| __x64_sys_capset\n//// syscall_64.c\n\\\\\\\\ sys_call_table\n|||| x32_sys_call\n||||| do_syscall_x32\n|||||| do_syscall_64\n|||| x64_sys_call\n||||| do_syscall_x64\n|||||| do_syscall_64\n|| capability.c\n| __do_sys_landlock_restrict_self\n|| __se_sys_landlock_restrict_self\n||| __ia32_sys_landlock_restrict_self\n|||| ia32_sys_call\n||| __x64_sys_landlock_restrict_self\n//// syscall_64.c\n\\\\\\\\ sys_call_table\n|||| x32_sys_call\n|||| x64_sys_call\n|| syscalls.c\n| __sys_setfsgid\n|| __do_sys_setfsgid\n||| __se_sys_setfsgid\n|||| __ia32_sys_setfsgid\n||||| ia32_sys_call\n|||| __x64_sys_setfsgid\n///// syscall_64.c\n\\\\\\\\\\ sys_call_table\n||||| x32_sys_call\n||||| x64_sys_call\n||| sys.c\n|| __do_sys_setfsgid16\n||| __se_sys_setfsgid16\n|||| __ia32_sys_setfsgid16\n||||| ia32_sys_call\n|||| __x64_sys_setfsgid16\n||| uid16.c\n| __sys_setfsuid\n|| __do_sys_setfsuid\n||| __se_sys_setfsuid\n|||| __ia32_sys_setfsuid\n||||| ia32_sys_call\n|||| __x64_sys_setfsuid\n///// syscall_64.c\n\\\\\\\\\\ sys_call_table\n||||| x32_sys_call\n||||| x64_sys_call\n||| sys.c\n|| __do_sys_setfsuid16\n||| __se_sys_setfsuid16\n|||| __ia32_sys_setfsuid16\n||||| ia32_sys_call\n|||| __x64_sys_setfsuid16\n||| uid16.c\n| __sys_setgid\n|| __do_sys_setgid\n||| __se_sys_setgid\n|||| __ia32_sys_setgid\n||||| ia32_sys_call\n|||| __x64_sys_setgid\n///// syscall_64.c\n\\\\\\\\\\ sys_call_table\n||||| x32_sys_call\n||||| x64_sys_call\n||| sys.c\n|| __do_sys_setgid16\n||| __se_sys_setgid16\n|||| __ia32_sys_setgid16\n||||| ia32_sys_call\n|||| __x64_sys_setgid16\n||| uid16.c\n| __sys_setregid\n|| __do_sys_setregid\n||| __se_sys_setregid\n|||| __ia32_sys_setregid\n||||| ia32_sys_call\n|||| __x64_sys_setregid\n///// syscall_64.c\n\\\\\\\\\\ sys_call_table\n||||| x32_sys_call\n||||| x64_sys_call\n||| sys.c\n|| __do_sys_setregid16\n||| __se_sys_setregid16\n|||| __ia32_sys_setregid16\n||||| ia32_sys_call\n|||| __x64_sys_setregid16\n||| uid16.c\n| __sys_setresgid\n|| __do_sys_setresgid\n||| __se_sys_setresgid\n|||| __ia32_sys_setresgid\n||||| ia32_sys_call\n|||| __x64_sys_setresgid\n///// syscall_64.c\n\\\\\\\\\\ sys_call_table\n||||| x32_sys_call\n||||| x64_sys_call\n||| sys.c\n|| __do_sys_setresgid16\n||| __se_sys_setresgid16\n|||| __ia32_sys_setresgid16\n||||| ia32_sys_call\n|||| __x64_sys_setresgid16\n||| uid16.c\n| __sys_setresuid\n|| __do_sys_setresuid\n||| __se_sys_setresuid\n|||| __ia32_sys_setresuid\n||||| ia32_sys_call\n|||| __x64_sys_setresuid\n///// syscall_64.c\n\\\\\\\\\\ sys_call_table\n||||| x32_sys_call\n||||| x64_sys_call\n||| sys.c\n|| __do_sys_setresuid16\n||| __se_sys_setresuid16\n|||| __ia32_sys_setresuid16\n||||| ia32_sys_call\n|||| __x64_sys_setresuid16\n||| uid16.c\n| __sys_setreuid\n|| __do_sys_setreuid\n||| __se_sys_setreuid\n|||| __ia32_sys_setreuid\n||||| ia32_sys_call\n|||| __x64_sys_setreuid\n///// syscall_64.c\n\\\\\\\\\\ sys_call_table\n||||| x32_sys_call\n||||| x64_sys_call\n||| sys.c\n|| __do_sys_setreuid16\n||| __se_sys_setreuid16\n|||| __ia32_sys_setreuid16\n||||| ia32_sys_call\n|||| __x64_sys_setreuid16\n||| uid16.c\n| __sys_setuid\n|| __do_sys_setuid\n||| __se_sys_setuid\n|||| __ia32_sys_setuid\n||||| ia32_sys_call\n|||| __x64_sys_setuid\n///// syscall_64.c\n\\\\\\\\\\ sys_call_table\n||||| x32_sys_call\n||||| x64_sys_call\n||| sys.c\n|| __do_sys_setuid16\n||| __se_sys_setuid16\n|||| __ia32_sys_setuid16\n||||| ia32_sys_call\n|||| __x64_sys_setuid16\n||| uid16.c\n\n\n回复格式（**请严格按照格式回复**）：\n<think process> 一步一步表述你的思考过程，以及必要的解释 </think process>\n<pkg install cmd> 能直接在 shell 中执行的编译依赖安装命令，以 apt install 或者 pip install 开头，基于 debian 系统，不要加入任何 markdown 语法的前后缀 (如 apt install xxx)。如果没有必要，则留空，**不要在这里输出任何内容** </pkg install cmd>\n<code> 你的 C 语言代码，不要加入任何 markdown 语法的前后缀 </code>\n<code name> C 语言代码的文件名，应该符合 test_case_*.c 的格式 </code name>\n<compile cmd> 能够直接在 shell 中执行的编译命令，工作目录是 C 语言代码所在目录，不要加入任何 markdown 语法的前后缀 (如 gcc -lpthread test_case_netfilter.c -o test_case_netfilter) </compile cmd>\n' additional_kwargs={} response_metadata={}
